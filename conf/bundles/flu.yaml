# STATUS: legacy (Gen 1 base) -- HA/NA, no schema ordering; superseded
# Flu bundle
# Contains virus-specific overrides for Influenza A
defaults:
  - /virus: flu
  - /paths: flu
  - /embeddings: default
  - /dataset: default
  - /training: base
  - _self_

# ===================================================================
# DIRECTORY NAMING
# ===================================================================
# Optional manual directory suffix - set this to create a specific output directory
# - null: Auto-generate suffix from max_isolates_to_process and seed
# - string: Use this exact suffix (e.g., '_v2', '_seed_42_GTOs_2000')

run_suffix: null

# ===================================================================
# SEED MANAGEMENT
# ===================================================================
# Hierarchical seed system for reproducibility:
# - master_seed: Single seed that generates all process-specific seeds
# - process_seeds: Override specific stages (null = derive from master_seed)
# 
# Examples:
#   master_seed: 42, seed for all other process: null → use derived seed for all processes
#   master_seed: 42, process_seeds.preprocessing: 123 → preprocessing uses 123
#   master_seed: null, process_seeds.preprocessing: 42 → only preprocessing reproducible
#   master_seed: null → all processes use random seeds (non-reproducible)
#
# See docs/SEED_SYSTEM.md for detailed documentation

master_seed: 42  # Master seed for the entire experiment (null = random)

# Process-specific seeds (null = derive from master_seed)
process_seeds:
  preprocessing: null  # Data sampling and preprocessing
  embeddings: null     # ESM-2 embedding computation
  dataset: null        # Dataset splitting and augmentation
  training: null       # Model training and initialization
  evaluation: null     # Evaluation sampling and metrics

# ====================================================================
# PROTEIN SELECTION
# ====================================================================
# Override selected_functions to include a subset of proteins
virus:
  # selected_functions:
  #   - "RNA-dependent RNA polymerase PB2 subunit"  # PB2 (Segment 1)
  #   - "RNA-dependent RNA polymerase catalytic core PB1 subunit"  # PB1 (Segment 2)
  #   - "RNA-dependent RNA polymerase PA subunit"  # PA (Segment 3)
  selected_functions:
    - "Hemagglutinin precursor"  # HA0 (Segment 4)
    - "Neuraminidase protein"  # NA (Segment 6)

# ====================================================================
# MODEL AND DATASET OVERRIDES
# ====================================================================
# Embeddings overrides
embeddings:
  batch_size: 96

# Dataset overrides
dataset:
  use_selected_only: true  # Use selected_functions (a subset of protein functions)
  neg_to_pos_ratio: 1.0  # Ratio of negative to positive pairs; default is 1.0
  allow_same_func_negatives: false  # Whether to allow same-function negative pairs
  max_same_func_ratio: 0.5  # Maximum fraction of same-function negative pairs; ignored when allow_same_func_negatives=false
  max_isolates_to_process: 5000  # null = full dataset, or set to 100, 500, etc.

# Training overrides
training:
  patience: 15  # Early stopping
  batch_size: 16
  learning_rate: 0.001
  early_stopping_metric: 'f1'  # Metric for early stopping; Options: 'loss', 'f1', 'auc', null (default: 'loss')
  threshold_metric: null  # Threshold optimization metric; Options: 'f1', 'f0.5', 'f2', null (default: 0.5)
